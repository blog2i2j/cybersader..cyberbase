---
aliases: []
tags: []
publish: true
permalink:
date created: Wednesday, April 16th 2025, 2:16 pm
date modified: Wednesday, April 16th 2025, 2:44 pm
---

- Running things in memory
	- Using Powershell ISE and Assembly Reflection makes it easier to run tooling in environments, but Crowdstrike, Threatlocker, and other tools are getting better at finding it

- If assumed compromise testing had a checklist, it _could_ look something like the following.
	- System/Domain Analysis and Situational Awareness
	- Command and Control (c2) and Egress Posture Checks
	- File Share Analysis: Permissions, Contents, Risks
		- Snaffler is used often
	- Kerberoasting
		- If you run service accounts, any user can request tickets on behalf of the service accounts.  Ticket has crack-able credentials.
	- Active Directory Certificate Services
		- Certipi
	- Microsoft Endpoint Configuration Management (yes, we know it's _Manager_)
	    - MECM/SCCM
		    - 2nd most common priv-esc
		    - They use the endpoint NAA account (network access account)
	    - InTune
		    - Exposing Intune at the end of Graph API
		    - They look for MS-MAN service
		    - InTune and other modern techniques for this - webcast "First Cred is the Deepest" f/Gabriel at BHIS
	- Other organizational risk analysis depending on market vertical context.

- Snaffler on network shares
	- Good way to look for super sensitive stuff
	- If you don't have roles, then you probably don't have a least privilege system

- What about application whitelisting
	- If you don't have something like Carbon Black App Control, then good luck

- People are starting to get around heuristics by having malware do random types of operations for awhile before executing the malicious payloads

- Kerberoasting
	- Rubeus is a good tool
	- You could enforce to AES 256 in environments
	- Just don't use 8 character passwords for SPNs

- ADExplorer vs Bloodhound
	- Same data, but referenced differently
	- You can obfuscate Bloodhound, but it takes more effort
	- 
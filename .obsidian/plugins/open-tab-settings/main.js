/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";var h=Object.defineProperty;var w=Object.getOwnPropertyDescriptor;var b=Object.getOwnPropertyNames;var O=Object.prototype.hasOwnProperty;var m=(a,n)=>{for(var e in n)h(a,e,{get:n[e],enumerable:!0})},v=(a,n,e,s)=>{if(n&&typeof n=="object"||typeof n=="function")for(let t of b(n))!O.call(a,t)&&t!==e&&h(a,t,{get:()=>n[t],enumerable:!(s=w(n,t))||s.enumerable});return a};var S=a=>v(h({},"__esModule",{value:!0}),a);var E={};m(E,{default:()=>g});module.exports=S(E);var i=require("obsidian");function f(a,n){let e=Object.keys(n).map(s=>k(a,s,n[s]));return e.length===1?e[0]:function(){e.forEach(s=>s())}}function k(a,n,e){let s=a[n],t=a.hasOwnProperty(n),p=t?s:function(){return Object.getPrototypeOf(a)[n].apply(this,arguments)},o=e(p);return s&&Object.setPrototypeOf(o,s),Object.setPrototypeOf(r,o),a[n]=r,c;function r(...l){return o===p&&a[n]===r&&c(),o.apply(this,l)}function c(){a[n]===r&&(t?a[n]=p:delete a[n]),o!==p&&(o=p,Object.setPrototypeOf(r,s||Function))}}var T={openInNewTab:!0,deduplicateTabs:!0};var g=class extends i.Plugin{constructor(){super(...arguments);this.settings=T;this.monkeyPatches=[]}async onload(){await this.loadSettings(),this.addSettingTab(new y(this.app,this));let e=this;this.monkeyPatches.push(f(i.Workspace.prototype,{getLeaf(s){return function(t,...p){let o;return e.settings.openInNewTab&&!t?(t="tab",o=s.call(this,t,...p),e.app.vault.getConfig("focusNewTab")||e.app.workspace.setActiveLeaf(o,{focus:!0})):(t=t=="same"?!1:t,o=s.call(this,t,...p)),o.openTabSettingsOriginalPaneType=t||"same",o}}})),this.monkeyPatches.push(f(i.WorkspaceLeaf.prototype,{openFile(s){return async function(t,p,...o){var l;let r=typeof this.openTabSettingsOriginalPaneType!="string"||!["same","tab"].includes(this.openTabSettingsOriginalPaneType),c=this.view.getViewType()=="empty";if(e.settings.deduplicateTabs&&(!c||!r)){let u=await e.findMatchingLeaves(t);if(!u.includes(this)&&u.length>0){let d=(l=e.app.workspace.getActiveViewOfType(i.View))==null?void 0:l.leaf,P=await s.call(u[0],t,{...p,active:d==this},...o);return c&&await this.detach(),P}}return s.call(this,t,p,...o)}}})),this.registerEvent(this.app.workspace.on("file-menu",(s,t,p,o)=>{t instanceof i.TFile&&s.addItem(r=>{r.setSection("open"),r.setIcon("file-minus"),r.setTitle("Open in same tab"),r.onClick(()=>{this.app.workspace.getLeaf("same").openFile(t)})})}))}onunload(){for(let e of this.monkeyPatches)e()}async loadSettings(){this.settings=Object.assign({},T,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}async findMatchingLeaves(e){let s=[];return this.app.workspace.iterateAllLeaves(t=>{var l,u;let p=t.getRoot(),o=p instanceof i.WorkspaceRoot||p instanceof i.WorkspaceFloating,r=((u=(l=t.getViewState())==null?void 0:l.state)==null?void 0:u.file)==e.path,c=this.app.viewRegistry.getTypeByExtension(e.extension)==t.view.getViewType();o&&r&&c&&s.push(t)}),s}},y=class extends i.PluginSettingTab{constructor(n,e){super(n,e),this.plugin=e}display(){this.containerEl.empty(),new i.Setting(this.containerEl).setName("Always open in new tab").setDesc("Open files in a new tab by default.").addToggle(n=>n.setValue(this.plugin.settings.openInNewTab).onChange(async e=>{this.plugin.settings.openInNewTab=e,await this.plugin.saveSettings()})),new i.Setting(this.containerEl).setName("Deduplicate tabs").setDesc("If a tab is already open, focus it instead of re-opening it.").addToggle(n=>n.setValue(this.plugin.settings.deduplicateTabs).onChange(async e=>{this.plugin.settings.deduplicateTabs=e,await this.plugin.saveSettings()})),new i.Setting(this.containerEl).setDesc('See also: "Always focus in new tab" in Obsidian Editor options')}};

/* nosourcemap */